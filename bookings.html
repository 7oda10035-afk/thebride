{% extends "base.html" %}

{% block title %}Ø§Ù„Ø­Ø¬ÙˆØ²Ø§Øª{% endblock %}

{% block content %}
<h1 style="color: #8B4513; margin-bottom: 20px;">ğŸ“… Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø­Ø¬ÙˆØ²Ø§Øª</h1>

<div style="margin-bottom: 20px; display: flex; gap: 10px;">
    <input type="text" id="search" placeholder="Ø¨Ø­Ø« Ø¨Ø§Ø³Ù… Ø§Ù„Ø¹Ù…ÙŠÙ„ Ø£Ùˆ Ø§Ù„Ù‡Ø§ØªÙ..." value="{{ search_query }}"
           style="flex: 1; padding: 10px; border: 1px solid #ddd; border-radius: 5px;">
    <select id="status" style="padding: 10px; border: 1px solid #ddd; border-radius: 5px;">
        <option value="all" {% if current_status == 'all' %}selected{% endif %}>Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ø§Ù„Ø§Øª</option>
        <option value="active" {% if current_status == 'active' %}selected{% endif %}>Ù†Ø´Ø·Ø©</option>
        <option value="returned" {% if current_status == 'returned' %}selected{% endif %}>ØªÙ… Ø§Ù„Ø¥Ø±Ø¬Ø§Ø¹</option>
    </select>
    <a href="{{ url_for('add_booking') }}" class="btn btn-primary">â• Ø¥Ø¶Ø§ÙØ© Ø­Ø¬Ø²</a>
</div>

<div style="background: white; border-radius: 10px; overflow: hidden;">
    <table>
        <thead>
            <tr>
                <th>Ø§Ù„Ø¹Ù…ÙŠÙ„</th>
                <th>Ø§Ù„ÙØ³ØªØ§Ù†</th>
                <th>ØªØ§Ø±ÙŠØ® Ø§Ù„Ø­Ø¬Ø²</th>
                <th>ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¥Ø±Ø¬Ø§Ø¹</th>
                <th>Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ù…Ø¯ÙÙˆØ¹</th>
                <th>Ø§Ù„Ø­Ø§Ù„Ø©</th>
                <th>Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª</th>
            </tr>
        </thead>
        <tbody>
            {% for booking in bookings %}
            <tr>
                <td>
                    <strong>{{ booking.customer_name }}</strong><br>
                    <small>{{ booking.customer_phone }}</small>
                </td>
                <td>{{ booking.dress.dress_number }}</td>
                <td>{{ booking.booking_date.strftime('%Y-%m-%d') }}</td>
                <td>{{ booking.return_date.strftime('%Y-%m-%d') if booking.return_date else '-' }}</td>
                <td>{{ "%.2f"|format(booking.deposit_paid) }} Ø±ÙŠØ§Ù„</td>
                <td>
                    <span style="padding: 5px 10px; border-radius: 15px; 
                                 background: {% if booking.status == 'active' %}#d4edda{% else %}#d1ecf1{% endif %};
                                 color: {% if booking.status == 'active' %}#155724{% else %}#0c5460{% endif %};">
                        {{ "Ù†Ø´Ø·" if booking.status == 'active' else "ØªÙ… Ø§Ù„Ø¥Ø±Ø¬Ø§Ø¹" }}
                    </span>
                </td>
                <td>
                    {% if booking.status == 'active' %}
                    <form action="{{ url_for('return_booking', booking_id=booking.id) }}" method="POST" 
                          style="display: inline;" onsubmit="return confirm('Ù‡Ù„ ØªØ±ÙŠØ¯ ØªØ³Ø¬ÙŠÙ„ Ø¥Ø±Ø¬Ø§Ø¹ Ù‡Ø°Ø§ Ø§Ù„ÙØ³ØªØ§Ù†ØŸ');">
                        <button type="submit" class="btn btn-success" style="padding: 5px 10px;">Ø¥Ø±Ø¬Ø§Ø¹</button>
                    </form>
                    {% endif %}
                </td>
            </tr>
            {% else %}
            <tr>
                <td colspan="7" style="text-align: center; padding: 40px;">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø­Ø¬ÙˆØ²Ø§Øª</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>

<script>
document.getElementById('search').addEventListener('keyup', function(e) {
    if (e.key === 'Enter') {
        window.location.href = `?search=${this.value}&status=${document.getElementById('status').value}`;
    }
});
document.getElementById('status').addEventListener('change', function() {
    window.location.href = `?search=${document.getElementById('search').value}&status=${this.value}`;
});
</script>
{% endblock %}
